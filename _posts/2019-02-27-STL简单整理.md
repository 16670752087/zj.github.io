---
title: STL简单整理
categories: 程序设计
date: 2019-02-27 19:00:00
---
STL的全称是Standard Template Library，即标准模板库。STL是C++标准程序库的核心，深刻影响了标准程序库的整体结构，STL内的所有组件都由模板（template）构成，旨在为问题提供最通用的容器和解决算法。
# 表示一个元素序列的几种方法
例如，有如下十个数线性排列，下标地址从`0`开始：
```
40,41,42,43,44,45,46,47,48,49
```
## 全闭合区间
数学上的表示是$[left,right]$或$[first,last]$，用这个序列第一个和最后一个元素的地址表示一个区间内的所有元素，则$[2,9]$表示了序列
```
42,43,44,45,46,47,48,49
```
## 左闭合区间
数学上的表示是$[begin,end)$，用这个序列第一个和最后一个元素**后一个**的地址来表示一个区间内的左右元素，相当于全闭合区间里的$[begin,end-1]$。`end`可以指向一个不存在元素的地址，例如$[2,10)$同样表示了上面这个序列。
## 子串区间
数学上的表示是$[position,position+length)$，表示了从给定元素开始的若干元素。例如，$[2,2+8)$同样表示了上面这个序列。
# 选择左闭合区间表示的优越性
## 访问方便，且对迭代器的要求较低
```cpp
for (it=begin; it!=end; ++it) {} // 使用左闭合区间
for (it=left; it<=right; ++it) {} // 使用全闭合区间
for (int i=0; i!=length; ++i) {} // 使用子串区间
```
在遍历一个元素序列时，三种表示法通常像上面这样遍历。这时，全闭合区间使用了`<=`运算，要求高于`!=`（通常，一个元素可以比较大小时一定可以判断相等与否；但反之不然）；子串需要额外维护一个计数器随着地址的变化而变化，较为麻烦。
## 查找方便
查找target，返回的位置==end，说明在范围内没有找到target。
## 便于二分
当需要取中间元素的时候，`mid=begin+end/2`的定位问题。如果区间元素的个数是奇数个，那么mid永远是指向中间的元素；如果区间元素是偶数个，那么mid永远指向后半段区间的首元素。这样做在二分查找等一些算法的实现上特别有优势。

mid的规范写法是`mid=begin+(end-begin)/2`。
## 快速统计区间内元素
$end-begin=length$。推论是，如果$begin==end$那么表示的是一个空区间。
# 五类迭代器
一图解释五类迭代器之间的继承关系：

<div id="mermaid">
graph LR
输入迭代器-->前向迭代器
输出迭代器-->前向迭代器
前向迭代器-->双向迭代器
双向迭代器-->随机访问迭代器
</div>

## 输入迭代器（input iterator）
只读，不写；单遍扫描，只能递增。

输入迭代器只支持顺序访问，通常用于读取序列中的元素。对于一个输入迭代器`it`，`*it++`保证是有效的，但递增它可能导致所有其他指向流的迭代器失效。其结果就是，不保证其状态可以保存下来并用来访问元素。因此，输入迭代器只能用于单遍扫描的算法。支持如下操作：
 - 相等（`==`）、不等（`!=`）比较。
 - 用于推进迭代器的前置和后置递增（`++`）。
 - 解引用（`*`），只能出现在赋值运算的右侧；箭头运算符（`->`），`it->member`等价于`(*it)->member`。

算法`find`要求输入迭代器；而类型`istream_iterator`是一种输入迭代器。
## 输出迭代器（output iterator）
只写，不读；单遍扫描，只能递增。可以看作输入迭代器功能上的补集。

只能向解引用的输出迭代器赋值一次，类似输入迭代器，输出迭代器也只能用于单遍扫描的算法，通常用作算法的目标位置。支持如下操作：
 - 用于推进迭代器的前置和后置递增（`++`）。
 - 解引用（`*`），只能出现在赋值运算的左侧。

算法`fill`要求输出迭代器；而类型`ostream_iterator`是一种输出迭代器。
## 前向迭代器（forward iterator）
可读写；多遍扫描，只能递增。

可以读写元素，只能在序列中沿着一个方向移动，支持所有输入迭代器和输出迭代器的操作，而且可以多次读写同一个元素。因此，可以保存前向迭代器的状态，使用前向迭代器的算法可以进行多遍扫描。

算法`replace`要求前向迭代器；容器`forward_list`上的迭代器是前向迭代器。
## 双向迭代器（bidrectional iterator）
可读写；多遍扫描，能递增递减。

可正向/反向读写序列中的元素。除支持所有前向迭代器的操作之外，双向迭代器还支持前置和后置递减（`--`）。

算法`reverse`要求双向迭代器；除了`forward_list`之外，其他标准库容器上的迭代器都是双向迭代器。
## 随机访问迭代器（random-access iterator）
可读写；多遍扫描，支持全部迭代器运算。

提供在常数时间内访问序列中任意元素的能力，除支持双向迭代器的所有操作外，还支持：
 - 用于比较两个迭代器的相对位置（`>`、`<`、`>=`、`<=`）。
 - 迭代器和一个整数值的加减运算（`+`、`+=`、`-`、`-=`），计算结果迭代器在序列中前进或后退给定整数后的迭代器。
 - 迭代器之间的减法（`-`），得到两个迭代器之间的距离。
 - 下标运算符（`[]`），`it[n]`与`*(it[n])`等价。

算法`sort`要求随机访问迭代器；容器`vector`上的迭代器和用于访问内置数组的指针是随机访问迭代器。
